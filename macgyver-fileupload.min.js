!function(a,b,c){!function(a,b){function c(b,c){var e,f,g,h=b.nodeName.toLowerCase();return"area"===h?(e=b.parentNode,f=e.name,b.href&&f&&"map"===e.nodeName.toLowerCase()?(g=a("img[usemap=#"+f+"]")[0],!!g&&d(g)):!1):(/input|select|textarea|button|object/.test(h)?!b.disabled:"a"===h?b.href||c:c)&&d(b)}function d(b){return a.expr.filters.visible(b)&&!a(b).parents().addBack().filter(function(){return"hidden"===a.css(this,"visibility")}).length}var e=0,f=/^ui-id-\d+$/;a.ui=a.ui||{},a.extend(a.ui,{version:"@VERSION",keyCode:{BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,LEFT:37,NUMPAD_ADD:107,NUMPAD_DECIMAL:110,NUMPAD_DIVIDE:111,NUMPAD_ENTER:108,NUMPAD_MULTIPLY:106,NUMPAD_SUBTRACT:109,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SPACE:32,TAB:9,UP:38}}),a.fn.extend({focus:function(b){return function(c,d){return"number"==typeof c?this.each(function(){var b=this;setTimeout(function(){a(b).focus(),d&&d.call(b)},c)}):b.apply(this,arguments)}}(a.fn.focus),scrollParent:function(){var b;return b=a.ui.ie&&/(static|relative)/.test(this.css("position"))||/absolute/.test(this.css("position"))?this.parents().filter(function(){return/(relative|absolute|fixed)/.test(a.css(this,"position"))&&/(auto|scroll)/.test(a.css(this,"overflow")+a.css(this,"overflow-y")+a.css(this,"overflow-x"))}).eq(0):this.parents().filter(function(){return/(auto|scroll)/.test(a.css(this,"overflow")+a.css(this,"overflow-y")+a.css(this,"overflow-x"))}).eq(0),/fixed/.test(this.css("position"))||!b.length?a(document):b},zIndex:function(c){if(c!==b)return this.css("zIndex",c);if(this.length)for(var d,e,f=a(this[0]);f.length&&f[0]!==document;){if(d=f.css("position"),("absolute"===d||"relative"===d||"fixed"===d)&&(e=parseInt(f.css("zIndex"),10),!isNaN(e)&&0!==e))return e;f=f.parent()}return 0},uniqueId:function(){return this.each(function(){this.id||(this.id="ui-id-"+ ++e)})},removeUniqueId:function(){return this.each(function(){f.test(this.id)&&a(this).removeAttr("id")})}}),a.extend(a.expr[":"],{data:a.expr.createPseudo?a.expr.createPseudo(function(b){return function(c){return!!a.data(c,b)}}):function(b,c,d){return!!a.data(b,d[3])},focusable:function(b){return c(b,!isNaN(a.attr(b,"tabindex")))},tabbable:function(b){var d=a.attr(b,"tabindex"),e=isNaN(d);return(e||d>=0)&&c(b,!e)}}),a("<a>").outerWidth(1).jquery||a.each(["Width","Height"],function(c,d){function e(b,c,d,e){return a.each(f,function(){c-=parseFloat(a.css(b,"padding"+this))||0,d&&(c-=parseFloat(a.css(b,"border"+this+"Width"))||0),e&&(c-=parseFloat(a.css(b,"margin"+this))||0)}),c}var f="Width"===d?["Left","Right"]:["Top","Bottom"],g=d.toLowerCase(),h={innerWidth:a.fn.innerWidth,innerHeight:a.fn.innerHeight,outerWidth:a.fn.outerWidth,outerHeight:a.fn.outerHeight};a.fn["inner"+d]=function(c){return c===b?h["inner"+d].call(this):this.each(function(){a(this).css(g,e(this,c)+"px")})},a.fn["outer"+d]=function(b,c){return"number"!=typeof b?h["outer"+d].call(this,b):this.each(function(){a(this).css(g,e(this,b,!0,c)+"px")})}}),a.fn.addBack||(a.fn.addBack=function(a){return this.add(null==a?this.prevObject:this.prevObject.filter(a))}),a("<a>").data("a-b","a").removeData("a-b").data("a-b")&&(a.fn.removeData=function(b){return function(c){return arguments.length?b.call(this,a.camelCase(c)):b.call(this)}}(a.fn.removeData)),a.ui.ie=!!/msie [\w.]+/.exec(navigator.userAgent.toLowerCase()),a.support.selectstart="onselectstart"in document.createElement("div"),a.fn.extend({disableSelection:function(){return this.bind((a.support.selectstart?"selectstart":"mousedown")+".ui-disableSelection",function(a){a.preventDefault()})},enableSelection:function(){return this.unbind(".ui-disableSelection")}}),a.extend(a.ui,{plugin:{add:function(b,c,d){var e,f=a.ui[b].prototype;for(e in d)f.plugins[e]=f.plugins[e]||[],f.plugins[e].push([c,d[e]])},call:function(a,b,c){var d,e=a.plugins[b];if(e&&a.element[0].parentNode&&11!==a.element[0].parentNode.nodeType)for(d=0;d<e.length;d++)a.options[e[d][0]]&&e[d][1].apply(a.element,c)}},hasScroll:function(b,c){if("hidden"===a(b).css("overflow"))return!1;var d=c&&"left"===c?"scrollLeft":"scrollTop",e=!1;return b[d]>0?!0:(b[d]=1,e=b[d]>0,b[d]=0,e)}})}(jQuery),function(a,b){var c=0,d=Array.prototype.slice,e=a.cleanData;a.cleanData=function(b){for(var c,d=0;null!=(c=b[d]);d++)try{a(c).triggerHandler("remove")}catch(f){}e(b)},a.widget=function(b,c,d){var e,f,g,h,i={},j=b.split(".")[0];b=b.split(".")[1],e=j+"-"+b,d||(d=c,c=a.Widget),a.expr[":"][e.toLowerCase()]=function(b){return!!a.data(b,e)},a[j]=a[j]||{},f=a[j][b],g=a[j][b]=function(a,b){return this._createWidget?(arguments.length&&this._createWidget(a,b),void 0):new g(a,b)},a.extend(g,f,{version:d.version,_proto:a.extend({},d),_childConstructors:[]}),h=new c,h.options=a.widget.extend({},h.options),a.each(d,function(b,d){return a.isFunction(d)?(i[b]=function(){var a=function(){return c.prototype[b].apply(this,arguments)},e=function(a){return c.prototype[b].apply(this,a)};return function(){var b,c=this._super,f=this._superApply;return this._super=a,this._superApply=e,b=d.apply(this,arguments),this._super=c,this._superApply=f,b}}(),void 0):(i[b]=d,void 0)}),g.prototype=a.widget.extend(h,{widgetEventPrefix:f?h.widgetEventPrefix:b},i,{constructor:g,namespace:j,widgetName:b,widgetFullName:e}),f?(a.each(f._childConstructors,function(b,c){var d=c.prototype;a.widget(d.namespace+"."+d.widgetName,g,c._proto)}),delete f._childConstructors):c._childConstructors.push(g),a.widget.bridge(b,g)},a.widget.extend=function(c){for(var e,f,g=d.call(arguments,1),h=0,i=g.length;i>h;h++)for(e in g[h])f=g[h][e],g[h].hasOwnProperty(e)&&f!==b&&(c[e]=a.isPlainObject(f)?a.isPlainObject(c[e])?a.widget.extend({},c[e],f):a.widget.extend({},f):f);return c},a.widget.bridge=function(c,e){var f=e.prototype.widgetFullName||c;a.fn[c]=function(g){var h="string"==typeof g,i=d.call(arguments,1),j=this;return g=!h&&i.length?a.widget.extend.apply(null,[g].concat(i)):g,h?this.each(function(){var d,e=a.data(this,f);return e?a.isFunction(e[g])&&"_"!==g.charAt(0)?(d=e[g].apply(e,i),d!==e&&d!==b?(j=d&&d.jquery?j.pushStack(d.get()):d,!1):void 0):a.error("no such method '"+g+"' for "+c+" widget instance"):a.error("cannot call methods on "+c+" prior to initialization; attempted to call method '"+g+"'")}):this.each(function(){var b=a.data(this,f);b?b.option(g||{})._init():a.data(this,f,new e(g,this))}),j}},a.Widget=function(){},a.Widget._childConstructors=[],a.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{disabled:!1,create:null},_createWidget:function(b,d){d=a(d||this.defaultElement||this)[0],this.element=a(d),this.uuid=c++,this.eventNamespace="."+this.widgetName+this.uuid,this.options=a.widget.extend({},this.options,this._getCreateOptions(),b),this.bindings=a(),this.hoverable=a(),this.focusable=a(),d!==this&&(a.data(d,this.widgetFullName,this),this._on(!0,this.element,{remove:function(a){a.target===d&&this.destroy()}}),this.document=a(d.style?d.ownerDocument:d.document||d),this.window=a(this.document[0].defaultView||this.document[0].parentWindow)),this._create(),this._trigger("create",null,this._getCreateEventData()),this._init()},_getCreateOptions:a.noop,_getCreateEventData:a.noop,_create:a.noop,_init:a.noop,destroy:function(){this._destroy(),this.element.unbind(this.eventNamespace).removeData(this.widgetName).removeData(this.widgetFullName).removeData(a.camelCase(this.widgetFullName)),this.widget().unbind(this.eventNamespace).removeAttr("aria-disabled").removeClass(this.widgetFullName+"-disabled ui-state-disabled"),this.bindings.unbind(this.eventNamespace),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")},_destroy:a.noop,widget:function(){return this.element},option:function(c,d){var e,f,g,h=c;if(0===arguments.length)return a.widget.extend({},this.options);if("string"==typeof c)if(h={},e=c.split("."),c=e.shift(),e.length){for(f=h[c]=a.widget.extend({},this.options[c]),g=0;g<e.length-1;g++)f[e[g]]=f[e[g]]||{},f=f[e[g]];if(c=e.pop(),d===b)return f[c]===b?null:f[c];f[c]=d}else{if(d===b)return this.options[c]===b?null:this.options[c];h[c]=d}return this._setOptions(h),this},_setOptions:function(a){var b;for(b in a)this._setOption(b,a[b]);return this},_setOption:function(a,b){return this.options[a]=b,"disabled"===a&&(this.widget().toggleClass(this.widgetFullName+"-disabled ui-state-disabled",!!b).attr("aria-disabled",b),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")),this},enable:function(){return this._setOption("disabled",!1)},disable:function(){return this._setOption("disabled",!0)},_on:function(b,c,d){var e,f=this;"boolean"!=typeof b&&(d=c,c=b,b=!1),d?(c=e=a(c),this.bindings=this.bindings.add(c)):(d=c,c=this.element,e=this.widget()),a.each(d,function(d,g){function h(){return b||f.options.disabled!==!0&&!a(this).hasClass("ui-state-disabled")?("string"==typeof g?f[g]:g).apply(f,arguments):void 0}"string"!=typeof g&&(h.guid=g.guid=g.guid||h.guid||a.guid++);var i=d.match(/^(\w+)\s*(.*)$/),j=i[1]+f.eventNamespace,k=i[2];k?e.delegate(k,j,h):c.bind(j,h)})},_off:function(a,b){b=(b||"").split(" ").join(this.eventNamespace+" ")+this.eventNamespace,a.unbind(b).undelegate(b)},_delay:function(a,b){function c(){return("string"==typeof a?d[a]:a).apply(d,arguments)}var d=this;return setTimeout(c,b||0)},_hoverable:function(b){this.hoverable=this.hoverable.add(b),this._on(b,{mouseenter:function(b){a(b.currentTarget).addClass("ui-state-hover")},mouseleave:function(b){a(b.currentTarget).removeClass("ui-state-hover")}})},_focusable:function(b){this.focusable=this.focusable.add(b),this._on(b,{focusin:function(b){a(b.currentTarget).addClass("ui-state-focus")},focusout:function(b){a(b.currentTarget).removeClass("ui-state-focus")}})},_trigger:function(b,c,d){var e,f,g=this.options[b];if(d=d||{},c=a.Event(c),c.type=(b===this.widgetEventPrefix?b:this.widgetEventPrefix+b).toLowerCase(),c.target=this.element[0],f=c.originalEvent)for(e in f)e in c||(c[e]=f[e]);return this.element.trigger(c,d),!(a.isFunction(g)&&g.apply(this.element[0],[c].concat(d))===!1||c.isDefaultPrevented())}},a.each({show:"fadeIn",hide:"fadeOut"},function(b,c){a.Widget.prototype["_"+b]=function(d,e,f){"string"==typeof e&&(e={effect:e});var g,h=e?e===!0||"number"==typeof e?c:e.effect||c:b;e=e||{},"number"==typeof e&&(e={duration:e}),g=!a.isEmptyObject(e),e.complete=f,e.delay&&d.delay(e.delay),g&&a.effects&&a.effects.effect[h]?d[b](e):h!==b&&d[h]?d[h](e.duration,e.easing,f):d.queue(function(c){a(this)[b](),f&&f.call(d[0]),c()})}})}(jQuery),function(b){"use strict";"function"==typeof define&&define.amd?define(["jquery","jquery.ui.widget"],b):b(a.jQuery)}(function(b){"use strict";b.support.fileInput=!(new RegExp("(Android (1\\.[0156]|2\\.[01]))|(Windows Phone (OS 7|8\\.0))|(XBLWP)|(ZuneWP)|(WPDesktop)|(w(eb)?OSBrowser)|(webOS)|(Kindle/(1\\.0|2\\.[05]|3\\.0))").test(a.navigator.userAgent)||b('<input type="file">').prop("disabled")),b.support.xhrFileUpload=!(!a.XMLHttpRequestUpload||!a.FileReader),b.support.xhrFormDataFileUpload=!!a.FormData,b.support.blobSlice=a.Blob&&(Blob.prototype.slice||Blob.prototype.webkitSlice||Blob.prototype.mozSlice),b.widget("blueimp.fileupload",{options:{dropZone:b(document),pasteZone:b(document),fileInput:c,replaceFileInput:!0,paramName:c,singleFileUploads:!0,limitMultiFileUploads:c,sequentialUploads:!1,limitConcurrentUploads:c,forceIframeTransport:!1,redirect:c,redirectParamName:c,postMessage:c,multipart:!0,maxChunkSize:c,uploadedBytes:c,recalculateProgress:!0,progressInterval:100,bitrateInterval:500,autoUpload:!0,messages:{uploadedBytes:"Uploaded bytes exceed file size"},i18n:function(a,c){return a=this.messages[a]||a.toString(),c&&b.each(c,function(b,c){a=a.replace("{"+b+"}",c)}),a},formData:function(a){return a.serializeArray()},add:function(a,c){(c.autoUpload||c.autoUpload!==!1&&b(this).fileupload("option","autoUpload"))&&c.process().done(function(){c.submit()})},processData:!1,contentType:!1,cache:!1},_specialOptions:["fileInput","dropZone","pasteZone","multipart","forceIframeTransport"],_blobSlice:b.support.blobSlice&&function(){var a=this.slice||this.webkitSlice||this.mozSlice;return a.apply(this,arguments)},_BitrateTimer:function(){this.timestamp=Date.now?Date.now():(new Date).getTime(),this.loaded=0,this.bitrate=0,this.getBitrate=function(a,b,c){var d=a-this.timestamp;return(!this.bitrate||!c||d>c)&&(this.bitrate=(b-this.loaded)*(1e3/d)*8,this.loaded=b,this.timestamp=a),this.bitrate}},_isXHRUpload:function(a){return!a.forceIframeTransport&&(!a.multipart&&b.support.xhrFileUpload||b.support.xhrFormDataFileUpload)},_getFormData:function(a){var c;return"function"==typeof a.formData?a.formData(a.form):b.isArray(a.formData)?a.formData:"object"===b.type(a.formData)?(c=[],b.each(a.formData,function(a,b){c.push({name:a,value:b})}),c):[]},_getTotal:function(a){var c=0;return b.each(a,function(a,b){c+=b.size||1}),c},_initProgressObject:function(a){var c={loaded:0,total:0,bitrate:0};a._progress?b.extend(a._progress,c):a._progress=c},_initResponseObject:function(a){var b;if(a._response)for(b in a._response)a._response.hasOwnProperty(b)&&delete a._response[b];else a._response={}},_onProgress:function(a,b){if(a.lengthComputable){var c,d=Date.now?Date.now():(new Date).getTime();if(b._time&&b.progressInterval&&d-b._time<b.progressInterval&&a.loaded!==a.total)return;b._time=d,c=Math.floor(a.loaded/a.total*(b.chunkSize||b._progress.total))+(b.uploadedBytes||0),this._progress.loaded+=c-b._progress.loaded,this._progress.bitrate=this._bitrateTimer.getBitrate(d,this._progress.loaded,b.bitrateInterval),b._progress.loaded=b.loaded=c,b._progress.bitrate=b.bitrate=b._bitrateTimer.getBitrate(d,c,b.bitrateInterval),this._trigger("progress",a,b),this._trigger("progressall",a,this._progress)}},_initProgressListener:function(a){var c=this,d=a.xhr?a.xhr():b.ajaxSettings.xhr();d.upload&&(b(d.upload).bind("progress",function(b){var d=b.originalEvent;b.lengthComputable=d.lengthComputable,b.loaded=d.loaded,b.total=d.total,c._onProgress(b,a)}),a.xhr=function(){return d})},_isInstanceOf:function(a,b){return Object.prototype.toString.call(b)==="[object "+a+"]"},_initXHRData:function(a){var c,d=this,e=a.files[0],f=a.multipart||!b.support.xhrFileUpload,g=a.paramName[0];a.headers=b.extend({},a.headers),a.contentRange&&(a.headers["Content-Range"]=a.contentRange),f&&!a.blob&&this._isInstanceOf("File",e)||(a.headers["Content-Disposition"]='attachment; filename="'+encodeURI(e.name)+'"'),f?b.support.xhrFormDataFileUpload&&(a.postMessage?(c=this._getFormData(a),a.blob?c.push({name:g,value:a.blob}):b.each(a.files,function(b,d){c.push({name:a.paramName[b]||g,value:d})})):(d._isInstanceOf("FormData",a.formData)?c=a.formData:(c=new FormData,b.each(this._getFormData(a),function(a,b){c.append(b.name,b.value)})),a.blob?c.append(g,a.blob,e.name):b.each(a.files,function(b,e){(d._isInstanceOf("File",e)||d._isInstanceOf("Blob",e))&&c.append(a.paramName[b]||g,e,e.name)})),a.data=c):(a.contentType=e.type,a.data=a.blob||e),a.blob=null},_initIframeSettings:function(a){var c=b("<a></a>").prop("href",a.url).prop("host");a.dataType="iframe "+(a.dataType||""),a.formData=this._getFormData(a),a.redirect&&c&&c!==location.host&&a.formData.push({name:a.redirectParamName||"redirect",value:a.redirect})},_initDataSettings:function(a){this._isXHRUpload(a)?(this._chunkedUpload(a,!0)||(a.data||this._initXHRData(a),this._initProgressListener(a)),a.postMessage&&(a.dataType="postmessage "+(a.dataType||""))):this._initIframeSettings(a)},_getParamName:function(a){var c=b(a.fileInput),d=a.paramName;return d?b.isArray(d)||(d=[d]):(d=[],c.each(function(){for(var a=b(this),c=a.prop("name")||"files[]",e=(a.prop("files")||[1]).length;e;)d.push(c),e-=1}),d.length||(d=[c.prop("name")||"files[]"])),d},_initFormSettings:function(a){a.form&&a.form.length||(a.form=b(a.fileInput.prop("form")),a.form.length||(a.form=b(this.options.fileInput.prop("form")))),a.paramName=this._getParamName(a),a.url||(a.url=a.form.prop("action")||location.href),a.type=(a.type||"string"===b.type(a.form.prop("method"))&&a.form.prop("method")||"").toUpperCase(),"POST"!==a.type&&"PUT"!==a.type&&"PATCH"!==a.type&&(a.type="POST"),a.formAcceptCharset||(a.formAcceptCharset=a.form.attr("accept-charset"))},_getAJAXSettings:function(a){var c=b.extend({},this.options,a);return this._initFormSettings(c),this._initDataSettings(c),c},_getDeferredState:function(a){return a.state?a.state():a.isResolved()?"resolved":a.isRejected()?"rejected":"pending"},_enhancePromise:function(a){return a.success=a.done,a.error=a.fail,a.complete=a.always,a},_getXHRPromise:function(a,c,d){var e=b.Deferred(),f=e.promise();return c=c||this.options.context||f,a===!0?e.resolveWith(c,d):a===!1&&e.rejectWith(c,d),f.abort=e.promise,this._enhancePromise(f)},_addConvenienceMethods:function(a,c){var d=this,e=function(a){return b.Deferred().resolveWith(d,[a]).promise()};c.process=function(a,b){return(a||b)&&(c._processQueue=this._processQueue=(this._processQueue||e(this)).pipe(a,b)),this._processQueue||e(this)},c.submit=function(){return"pending"!==this.state()&&(c.jqXHR=this.jqXHR=d._trigger("submit",a,this)!==!1&&d._onSend(a,this)),this.jqXHR||d._getXHRPromise()},c.abort=function(){return this.jqXHR?this.jqXHR.abort():d._getXHRPromise()},c.state=function(){return this.jqXHR?d._getDeferredState(this.jqXHR):this._processQueue?d._getDeferredState(this._processQueue):void 0},c.progress=function(){return this._progress},c.response=function(){return this._response}},_getUploadedBytes:function(a){var b=a.getResponseHeader("Range"),c=b&&b.split("-"),d=c&&c.length>1&&parseInt(c[1],10);return d&&d+1},_chunkedUpload:function(a,c){a.uploadedBytes=a.uploadedBytes||0;var d,e,f=this,g=a.files[0],h=g.size,i=a.uploadedBytes,j=a.maxChunkSize||h,k=this._blobSlice,l=b.Deferred(),m=l.promise();return this._isXHRUpload(a)&&k&&(i||h>j)&&!a.data?c?!0:i>=h?(g.error=a.i18n("uploadedBytes"),this._getXHRPromise(!1,a.context,[null,"error",g.error])):(e=function(){var c=b.extend({},a),m=c._progress.loaded;c.blob=k.call(g,i,i+j,g.type),c.chunkSize=c.blob.size,c.contentRange="bytes "+i+"-"+(i+c.chunkSize-1)+"/"+h,f._initXHRData(c),f._initProgressListener(c),d=(f._trigger("chunksend",null,c)!==!1&&b.ajax(c)||f._getXHRPromise(!1,c.context)).done(function(d,g,j){i=f._getUploadedBytes(j)||i+c.chunkSize,m+c.chunkSize-c._progress.loaded&&f._onProgress(b.Event("progress",{lengthComputable:!0,loaded:i-c.uploadedBytes,total:i-c.uploadedBytes}),c),a.uploadedBytes=c.uploadedBytes=i,c.result=d,c.textStatus=g,c.jqXHR=j,f._trigger("chunkdone",null,c),f._trigger("chunkalways",null,c),h>i?e():l.resolveWith(c.context,[d,g,j])}).fail(function(a,b,d){c.jqXHR=a,c.textStatus=b,c.errorThrown=d,f._trigger("chunkfail",null,c),f._trigger("chunkalways",null,c),l.rejectWith(c.context,[a,b,d])})},this._enhancePromise(m),m.abort=function(){return d.abort()},e(),m):!1},_beforeSend:function(a,b){0===this._active&&(this._trigger("start"),this._bitrateTimer=new this._BitrateTimer,this._progress.loaded=this._progress.total=0,this._progress.bitrate=0),this._initResponseObject(b),this._initProgressObject(b),b._progress.loaded=b.loaded=b.uploadedBytes||0,b._progress.total=b.total=this._getTotal(b.files)||1,b._progress.bitrate=b.bitrate=0,this._active+=1,this._progress.loaded+=b.loaded,this._progress.total+=b.total},_onDone:function(a,c,d,e){var f=e._progress.total,g=e._response;e._progress.loaded<f&&this._onProgress(b.Event("progress",{lengthComputable:!0,loaded:f,total:f}),e),g.result=e.result=a,g.textStatus=e.textStatus=c,g.jqXHR=e.jqXHR=d,this._trigger("done",null,e)},_onFail:function(a,b,c,d){var e=d._response;d.recalculateProgress&&(this._progress.loaded-=d._progress.loaded,this._progress.total-=d._progress.total),e.jqXHR=d.jqXHR=a,e.textStatus=d.textStatus=b,e.errorThrown=d.errorThrown=c,this._trigger("fail",null,d)},_onAlways:function(a,b,c,d){this._trigger("always",null,d)},_onSend:function(a,d){d.submit||this._addConvenienceMethods(a,d);var e,f,g,h,i=this,j=i._getAJAXSettings(d),k=function(){return i._sending+=1,j._bitrateTimer=new i._BitrateTimer,e=e||((f||i._trigger("send",a,j)===!1)&&i._getXHRPromise(!1,j.context,f)||i._chunkedUpload(j)||b.ajax(j)).done(function(a,b,c){i._onDone(a,b,c,j)}).fail(function(a,b,c){i._onFail(a,b,c,j)}).always(function(a,b,c){if(i._onAlways(a,b,c,j),i._sending-=1,i._active-=1,j.limitConcurrentUploads&&j.limitConcurrentUploads>i._sending)for(var d=i._slots.shift();d;){if("pending"===i._getDeferredState(d)){d.resolve();break}d=i._slots.shift()}0===i._active&&i._trigger("stop")})};return this._beforeSend(a,j),this.options.sequentialUploads||this.options.limitConcurrentUploads&&this.options.limitConcurrentUploads<=this._sending?(this.options.limitConcurrentUploads>1?(g=b.Deferred(),this._slots.push(g),h=g.pipe(k)):(this._sequence=this._sequence.pipe(k,k),h=this._sequence),h.abort=function(){return f=[c,"abort","abort"],e?e.abort():(g&&g.rejectWith(j.context,f),k())},this._enhancePromise(h)):k()},_onAdd:function(a,c){var d,e,f,g,h=this,i=!0,j=b.extend({},this.options,c),k=j.limitMultiFileUploads,l=this._getParamName(j);if((j.singleFileUploads||k)&&this._isXHRUpload(j))if(!j.singleFileUploads&&k)for(f=[],d=[],g=0;g<c.files.length;g+=k)f.push(c.files.slice(g,g+k)),e=l.slice(g,g+k),e.length||(e=l),d.push(e);else d=l;else f=[c.files],d=[l];return c.originalFiles=c.files,b.each(f||c.files,function(e,g){var j=b.extend({},c);return j.files=f?g:[g],j.paramName=d[e],h._initResponseObject(j),h._initProgressObject(j),h._addConvenienceMethods(a,j),i=h._trigger("add",a,j)}),i},_replaceFileInput:function(a){var c=a.clone(!0);b("<form></form>").append(c)[0].reset(),a.after(c).detach(),b.cleanData(a.unbind("remove")),this.options.fileInput=this.options.fileInput.map(function(b,d){return d===a[0]?c[0]:d}),a[0]===this.element[0]&&(this.element=c)},_handleFileTreeEntry:function(a,c){var d,e=this,f=b.Deferred(),g=function(b){b&&!b.entry&&(b.entry=a),f.resolve([b])};return c=c||"",a.isFile?a._file?(a._file.relativePath=c,f.resolve(a._file)):a.file(function(a){a.relativePath=c,f.resolve(a)},g):a.isDirectory?(d=a.createReader(),d.readEntries(function(b){e._handleFileTreeEntries(b,c+a.name+"/").done(function(a){f.resolve(a)}).fail(g)},g)):f.resolve([]),f.promise()},_handleFileTreeEntries:function(a,c){var d=this;return b.when.apply(b,b.map(a,function(a){return d._handleFileTreeEntry(a,c)})).pipe(function(){return Array.prototype.concat.apply([],arguments)})},_getDroppedFiles:function(a){a=a||{};var c=a.items;return c&&c.length&&(c[0].webkitGetAsEntry||c[0].getAsEntry)?this._handleFileTreeEntries(b.map(c,function(a){var b;return a.webkitGetAsEntry?(b=a.webkitGetAsEntry(),b&&(b._file=a.getAsFile()),b):a.getAsEntry()})):b.Deferred().resolve(b.makeArray(a.files)).promise()},_getSingleFileInputFiles:function(a){a=b(a);var d,e,f=a.prop("webkitEntries")||a.prop("entries");if(f&&f.length)return this._handleFileTreeEntries(f);if(d=b.makeArray(a.prop("files")),d.length)d[0].name===c&&d[0].fileName&&b.each(d,function(a,b){b.name=b.fileName,b.size=b.fileSize});else{if(e=a.prop("value"),!e)return b.Deferred().resolve([]).promise();d=[{name:e.replace(/^.*\\/,"")}]}return b.Deferred().resolve(d).promise()},_getFileInputFiles:function(a){return a instanceof b&&1!==a.length?b.when.apply(b,b.map(a,this._getSingleFileInputFiles)).pipe(function(){return Array.prototype.concat.apply([],arguments)}):this._getSingleFileInputFiles(a)},_onChange:function(a){var c=this,d={fileInput:b(a.target),form:b(a.target.form)};this._getFileInputFiles(d.fileInput).always(function(b){d.files=b,c.options.replaceFileInput&&c._replaceFileInput(d.fileInput),c._trigger("change",a,d)!==!1&&c._onAdd(a,d)})},_onPaste:function(a){var c=a.originalEvent&&a.originalEvent.clipboardData&&a.originalEvent.clipboardData.items,d={files:[]};c&&c.length&&(b.each(c,function(a,b){var c=b.getAsFile&&b.getAsFile();c&&d.files.push(c)}),this._trigger("paste",a,d)!==!1&&this._onAdd(a,d))},_onDrop:function(a){a.dataTransfer=a.originalEvent&&a.originalEvent.dataTransfer;var b=this,c=a.dataTransfer,d={};c&&c.files&&c.files.length&&(a.preventDefault(),this._getDroppedFiles(c).always(function(c){d.files=c,b._trigger("drop",a,d)!==!1&&b._onAdd(a,d)}))},_onDragOver:function(a){a.dataTransfer=a.originalEvent&&a.originalEvent.dataTransfer;var c=a.dataTransfer,d={dropEffect:"copy",preventDefault:!0};c&&-1!==b.inArray("Files",c.types)&&this._trigger("dragover",a,d)!==!1&&(c.dropEffect=d.dropEffect,d.preventDefault&&a.preventDefault())},_initEventHandlers:function(){this._isXHRUpload(this.options)&&(this._on(this.options.dropZone,{dragover:this._onDragOver,drop:this._onDrop}),this._on(this.options.pasteZone,{paste:this._onPaste})),b.support.fileInput&&this._on(this.options.fileInput,{change:this._onChange})},_destroyEventHandlers:function(){this._off(this.options.dropZone,"dragover drop"),this._off(this.options.pasteZone,"paste"),this._off(this.options.fileInput,"change")},_setOption:function(a,c){var d=-1!==b.inArray(a,this._specialOptions);d&&this._destroyEventHandlers(),this._super(a,c),d&&(this._initSpecialOptions(),this._initEventHandlers())},_initSpecialOptions:function(){var a=this.options;a.fileInput===c?a.fileInput=this.element.is('input[type="file"]')?this.element:this.element.find('input[type="file"]'):a.fileInput instanceof b||(a.fileInput=b(a.fileInput)),a.dropZone instanceof b||(a.dropZone=b(a.dropZone)),a.pasteZone instanceof b||(a.pasteZone=b(a.pasteZone))},_getRegExp:function(a){var b=a.split("/"),c=b.pop();return b.shift(),new RegExp(b.join("/"),c)},_isRegExpOption:function(a,c){return"url"!==a&&"string"===b.type(c)&&/^\/.*\/[igm]{0,3}$/.test(c)},_initDataAttributes:function(){var a=this,c=this.options;b.each(b(this.element[0].cloneNode(!1)).data(),function(b,d){a._isRegExpOption(b,d)&&(d=a._getRegExp(d)),c[b]=d})},_create:function(){this._initDataAttributes(),this._initSpecialOptions(),this._slots=[],this._sequence=this._getXHRPromise(!0),this._sending=this._active=0,this._initProgressObject(this),this._initEventHandlers()},active:function(){return this._active},progress:function(){return this._progress},add:function(a){var c=this;a&&!this.options.disabled&&(a.fileInput&&!a.files?this._getFileInputFiles(a.fileInput).always(function(b){a.files=b,c._onAdd(null,a)}):(a.files=b.makeArray(a.files),this._onAdd(null,a)))},send:function(a){if(a&&!this.options.disabled){if(a.fileInput&&!a.files){var c,d,e=this,f=b.Deferred(),g=f.promise();return g.abort=function(){return d=!0,c?c.abort():(f.reject(null,"abort","abort"),g)},this._getFileInputFiles(a.fileInput).always(function(b){if(!d){if(!b.length)return f.reject(),void 0;a.files=b,c=e._onSend(null,a).then(function(a,b,c){f.resolve(a,b,c)},function(a,b,c){f.reject(a,b,c)})}}),this._enhancePromise(g)}if(a.files=b.makeArray(a.files),a.files.length)return this._onSend(null,a)}return this._getXHRPromise(!1,a&&a.context)}})}),b.module("Mac").directive("macUpload",["$rootScope","$parse","$timeout","$document","util",function(a,c,d,e,f){return{require:["macUpload","?macUploadPreviews"],controller:["$scope",function(){}],link:function(a,g,h,i){var j,k,l,m,n,o,p,q,r,s;return s=i[0],q=i[1],k={route:"",dropZone:null,submit:"",success:"",error:"",always:"",progress:"",formData:"",options:""},p=f.extendAttributes("macUpload",k,h),r=function(a,b){return null!=b?g.fileupload("option",a,b):void 0},j=function(b,d,e){var g;return g=f.capitalize(b),null!=h["macUpload"+g]?a.$apply(function(){var f,g,h,i,j,k,l;h=e.jqXHR,g=null!=(k=e.jqXHR)?k.status:void 0,j=(null!=(l=e.jqXHR)?l.responseText:void 0)||"";try{f=JSON.parse(j)}catch(m){i=m,f=j}return c(p[b])(a,{$event:d,$data:e,$status:g,$xhr:h,$response:f})}):void 0},o={url:c(p.route)(a)||"",replaceFileInput:!1,submit:function(a,b){var c;return c=function(){return j("submit",a,b)},null!=q?q.add(b.files,c):c()},fail:function(a,b){return j("error",a,b)},done:function(a,b){return j("success",a,b)},always:function(a,b){return g.val(""),j("always",a,b)},progress:function(a,b){return null!=q&&"function"==typeof q.updateProgress&&q.updateProgress(b),j("progress",a,b)}},null!=p.dropZone&&(e.bind("drop dragover",function(a){return a.preventDefault()}),l=null,m=g.parents(p.dropZone),e.bind("dragover",function(a){var c,e;return null!=l&&d.cancel(l),e=b.element(a.target).parents(p.dropZone),c=e.length?"addClass":"removeClass",m[c]("droppable"),l=d(function(){return null!=l&&d.cancel(l),m.removeClass("droppable")},250,!1)})),o.dropZone=m||b.element(),o.pasteZone=null,p.options&&(n=a.$eval(p.options)||{},b.extend(o,n)),g.fileupload(o).on(["fileuploadadd","fileuploadsubmit","fileuploadsend","fileuploaddone","fileuploadfail","fileuploadalways","fileuploadprogress","fileuploadprogressall","fileuploadstart","fileuploadstop","fileuploadchange","fileuploadpaste","fileuploaddrop","fileuploaddragover","fileuploadchunksend","fileuploadchunkdone","fileuploadchunkfail","fileuploadchunkalways","fileuploadprocessstart","fileuploadprocess","fileuploadprocessdone","fileuploadprocessfail","fileuploadprocessalways","fileuploadprocessstop"].join(" "),function(b,c){return a.$emit(b.type,c)}),a.$watch(p.route,function(a){return r("url",a)}),a.$watch(p.formData,function(a){return r("formData",a)}),a.$watch(p.options,function(a){return g.fileupload("option",a)})}}}]).directive("macUploadPreviews",["$rootScope",function(){return{restrict:"A",require:["macUploadPreviews","macUpload"],controller:["$scope","$attrs","$parse",function(a,b,c){var d,e;d=c(b.macUploadPreviews),e=d.assign,this.previews=function(b){return null!=b?e(a,b):d(a)},this.getByFilename=function(a){var b,c,d,e,f;for(d=this.previews()||[],b=e=f=d.length-1;e>=0;b=e+=-1)if(c=d[b],c.fileName===a)return c},this.add=function(a,b){var c,d,e,f,g,h,i,j=this;for(null==a&&(a=[]),i=[],f=0,g=a.length;g>f;f++)c=a[f],d=function(a){var d,e;return e=this.previews(),null!=e&&(d={fileName:c.name,type:c.type,fileData:null!=a?a.target.result:void 0},e.push(d),this.previews(e)),"function"==typeof b?b(d):void 0},"File"===(null!=(h=c.constructor)?h.name:void 0)?(e=new FileReader,e.onload=function(a){return d.apply(j,[a,"load"])},e.onerror=function(a){return d.apply(j,[a,"error"])},i.push(e.readAsDataURL(c))):i.push(d.apply(this));return i}}]}}]).directive("macUploadProgress",[function(){return{restrict:"A",require:["macUploadProgress","macUploadPreviews"],controller:["$scope",function(){return this.updatePreviewCtrl=function(a){return a.updateProgress=function(a){var b;return null!=(b=this.getByFilename(a.files[0].name))?b.progress=parseInt(a.loaded/a.total*100,10):void 0}},this}],link:function(a,b,c,d){var e,f;return f=d[0],e=d[1],f.updatePreviewCtrl(e)}}}])}(window,window.angular);